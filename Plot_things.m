clc;
clear;
close all;

t_gen = 3560.54081721256; % t_gen = 3560.54081721256;
P_rel = 35605.4081721257; %42726.4898065508;
P1 = 7121.08163442513; %7121.081634425;
P2 = 5934.23469535428; %  8545.29796131015
figure(1)
subplot(1,2,1)
x = t_gen + [2*P_rel,3*P_rel,5*P_rel,10*P_rel,20*P_rel,30*P_rel,40*P_rel]; x2 = x / P1;
y = [1710.5, 7550, 18500, 17800, 13000, 14100, 19000];% y = [6001;7850;7910;4881;4498;5448;5496]; %y = [320000,220000,95000,20000,4000,3000,1700];
P = polyfit(log(x),log(y),1); xfit = linspace(x(1),x(end),1000); yfit = exp(polyval(P,log(xfit)));
plot(x2,y,'o','LineWidth',2,'MarkerSize',7)
hold on
% plot(x2,[7059.11,6740.4,6354.7,5861.9,5404.7,5153.4,4982],'o','LineWidth',2,'MarkerSize',7)
% plot(x2,[7059.11,6740.4,6354.7,5861.9,5404.7,5153.4,4982],'o','LineWidth',2,'MarkerSize',7)
% plot(x2,ones(1,length(x2)) * 27046,'o','LineWidth',2,'MarkerSize',7)

% [0.379152416; ]
% loglog(xfit,yfit, 'r--')
xlabel('n P1 orbits')
ylabel('GMM growth parameter')
% ylabel('\sigma')
grid on

subplot(1,2,2)
x =t_gen + [2*P_rel,3*P_rel,5*P_rel,10*P_rel,20*P_rel,30*P_rel,40*P_rel];  x2 = x / P1;
y = [0.22213903632, 0.3162224102295, 0.30089403326806, 0.149034238686861, 0.0639983150657429,  0.0445079186242624, 0.038782037719224];% y = [0.3496, 0.2702, 0.1645, 0.0651, 0.0314, 0.0231, 0.0174]; % y = [2.552959513, 1.4302707, 0.5700845976, 0.1318646527795, 0.029605219483, 0.022097543, 0.0096685475787292];
%     x = [2,3,4,6,11,21,31,41]; y = [0.0027445192, 2.552959513, 1.4302707, 0.5700845976, 0.1318646527795, 0.029605219483, 0.022097543, 0.0096685475787292];
P = polyfit(log(x),log(y),1); xfit = linspace(x(1),x(end),1000); yfit = exp(polyval(P,log(xfit))); xfit2 = linspace(x(1),x(end),1000)/P1; 
plot(x2,y,'o','LineWidth',2,'MarkerSize',7)
hold on
% plot(x2,[0.3791524, 0.250333238, 0.147432470, 0.07138490, 0.034414241, 0.022434025, 0.016554757],'o','LineWidth',2,'MarkerSize',7)
% plot(x2,[0.74219895059, 0.501485777, 0.30417989778, 0.1533468906, 0.07699159, 0.051398819, 0.038575829],'o','LineWidth',2,'MarkerSize',7)
plot(xfit2,yfit, 'r--')
xlabel('n P1 orbits')
ylabel('\sigma')
grid on
% a;b;d;ao;n;t = [-1.05893709395951; 11.0984058969646; 6.64600663352005e-05; 8000; 0.000882335806516395; 1712620.13307924];
% a;b = [-0.737348323900236; 7.27922114076907]

figure(2)
subplot(1,2,1)
x =t_gen + [P_rel,2*P_rel,3*P_rel,5*P_rel,10*P_rel,20*P_rel,30*P_rel,40*P_rel]; 
y = [4373; 35; 45; 74; 185; 383; 521; 691];
plot(x,y,'*')
hold on
plot(x,y)
grid on
xlabel('Propagation Time')
ylabel('N')

subplot(1,2,2)
x =t_gen + [2*P_rel,3*P_rel,5*P_rel,10*P_rel,20*P_rel,30*P_rel,40*P_rel]; 
y = [35; 45; 74; 185; 383; 521; 691];
plot(x,y,'*')
hold on
plot(x,y)
grid on
xlabel('Propagation Time')
ylabel('N')

% plot([3,4,6,11,21,31],[550,830,950,765,700,1750],'o','LineWidth',2,'MarkerSize',7)
% semilogy([3,4,6,11,21,31,41],[1.9,1.6,1.25,1.053,1.012,1.014,1.005],'o','LineWidth',2,'MarkerSize',7)
% plot([2,3,4,6,11,21,31,41],[5.93652246648364e-05,0.10619557634912,0.0880526577487318,0.0578617590661758,0.0265482718383383,0.0118715607095809,0.0132731402718547,0.00773800142107866],'o','LineWidth',2,'MarkerSize',7)